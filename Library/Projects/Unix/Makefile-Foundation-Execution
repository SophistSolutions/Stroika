include ../../Configuration.mk
include	../../SharedBuildRules.mk
include	../../SharedMakeVariables.mk

SrcDir						=	$(StroikaRoot)Library/Sources/Stroika/Foundation/Execution/

SubDirs	=	\
	Platform/POSIX \

ifeq ($(shell uname), AIX)
SubDirs+=	\
	Platform/AIX
endif

.PHONY:				$(SubDirs)

vpath %cpp $(SrcDir)

Objs	=	\
	$(ObjDir)AbortableMutex.o\
	$(ObjDir)BlockingQueue.o\
	$(ObjDir)CommandLine.o\
	$(ObjDir)DLLSupport.o\
	$(ObjDir)Exceptions.o\
	$(ObjDir)ErrNoException.o\
	$(ObjDir)FeatureNotSupportedInThisVersionException.o\
	$(ObjDir)Finally.o\
	$(ObjDir)Function.o\
	$(ObjDir)Logger.o\
	$(ObjDir)Module.o\
	$(ObjDir)ModuleInit.o\
	$(ObjDir)OperationNotSupportedException.o\
	$(ObjDir)Process.o\
	$(ObjDir)ProcessRunner.o\
	$(ObjDir)ProgressMonitor.o\
	$(ObjDir)RequiredComponentMissingException.o\
	$(ObjDir)RequiredComponentVersionMismatchException.o\
	$(ObjDir)SharedStaticData.o\
	$(ObjDir)SilentException.o\
	$(ObjDir)Signals.o\
	$(ObjDir)SignalHandlers.o\
	$(ObjDir)Sleep.o\
	$(ObjDir)SpinLock.o\
	$(ObjDir)Synchronized.o\
	$(ObjDir)Thread.o\
	$(ObjDir)ThreadPool.o\
	$(ObjDir)TimeOutException.o\
	$(ObjDir)UserCanceledException.o\
	$(ObjDir)Users.o\
	$(ObjDir)WaitableEvent.o\
	$(ObjDir)WaitForIOReady.o\

all:	$(Objs)  $(SubDirs)



ifeq ($(shell uname), AIX)
PLATFORMAIX_OBJS := $(addprefix "Platform/AIX/", $(shell $(MAKE) --directory Platform/AIX -s list-objs))
else
PLATFORMAIX_OBJS := 
endif

PLATFORMPOSIX_OBJS := $(addprefix "Platform/POSIX/", $(shell $(MAKE) --directory Platform/POSIX -s list-objs))


list-objs::
	@echo $(PLATFORMAIX_OBJS) $(PLATFORMPOSIX_OBJS) 


Platform/AIX:
	@$(MAKE) --directory Platform/AIX -s

Platform/POSIX:
	@$(MAKE) --directory Platform/POSIX -s
