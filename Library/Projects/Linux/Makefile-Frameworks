include ../Configuration.mk
include	../SharedMakeVariables.mk
include	../SharedBuildRules.mk

RelPathToStroikaDevRoot		=	../../../../../
SrcDir						=       $(RelPathToStroikaDevRoot)Library/Sources/Stroika/Frameworks/


VPATH		=	$(SrcDir) $(StroikaLibDir)


SubDirs=	\
		Service\
		WebServer\
		UPnP\

.PHONY:	$(SubDirs)


all-objs:
	@for i in $(SubDirs);\
	do\
	    $(MAKE) --directory $$i -s all;\
	done


$(StroikaFrameworksLib):	all-objs
	@mkdir -p $(StroikaLibDir)
	@echo Creating $(StroikaFrameworksLib)...
	@rm -f $(StroikaFrameworksLib)
	@for i in $(SubDirs);\
	do\
	    (for oo in `$(MAKE) --directory $$i -s list-objs`; do (ar cq $(StroikaFrameworksLib) $$i/$$oo); done )\
	done
	@ranlib $(StroikaFrameworksLib)


all:	$(StroikaFrameworksLib)


clean::
	@for i in $(SubDirs);\
	do\
	     $(MAKE) --directory $$i -s clean;\
	done

clobber::
	do\
	    $(MAKE) --directory $$i -s clobber;\
	done
	@rm -f $(StroikaFrameworksLib)


Build:	all


